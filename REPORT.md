## Шаблон отчета:

Что произошло

УРОВЕНЬ УГРОЗЫ:
время:
хост:
ключи реестра:

Описание

IOC:
1. 
2. 
3. 

Не администратор/пользоатель

ТЕХНИКА MITRE:

## Пример отчета

### T1546.010 — AppInit DLLs

kql

sysmon.EventType:"SetValue" AND sysmon.TargetObject:"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_DLLs" AND sysmon.Details:(".dll") AND NOT sysmon.Details:("*\\Windows\\System32\\*")

------------------------------------------------------------------------------------------------------------------------------------------

Добавление вредоносной DLL в Appinit_Dlls для загрузки во все процессы

УРОВЕНЬ УГРОЗЫ: ВЫСОКИЙ
время: [@timestamp]
хост: [host.name]
ключи реестра: [sysmon.TargetObject]
DLL: [sysmon.Details]

В ключ реестра AppInit_DLLs добавлена библиотека DLL. Библиотеки, указанные в этом ключе, будут автоматически загружены в адресное пространство каждого пользовательского процесса, который загружает библиотеку user32.dll (что делают почти все графические приложения Windows). Это дает злоумышленнику широкий охват и глубокую устойчивость.

IOC:
1. Изменение значения AppInit_DLLs в реестре
2. Добавленная DLL не находится в каталоге `System32`
3. Значение может содержать путь к DLL во временной папке

Не администратор 
Технология AppInit_DLLs считается устаревшей и опасной. Ее почти не используют легитимные приложения или администраторы в современных системах. Изменение этого ключа — красный флаг.

ТЕХНИКА MITRE: T1546.010 - Event Triggered Execution: AppInit DLLs
